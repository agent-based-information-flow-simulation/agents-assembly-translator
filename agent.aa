# AGENT directive is followed by a non-whitespace UID token
# which corresponds to the agent class name
agent average_user

    # instruction PRM declares a parameter of name $arg1, type $arg2 and optional arguments $arg[3:]
    prm minutes_spent_daily_on_youtube, float, init, 205.7
    prm fakenews_susceptibility, float, dist_normal, 15, 32
    prm prefered_website, enum, facebook, 100, twitter, 0
    prm is_online, enum, yes, 95, no, 5
    prm friends, list, conn_list
    prm spam, list, msg_list

    # SETUPBEHAV directive is followed by a non-whitespace token
    # which corresponds to the OnSetup behaviour name
    setupbehav setup_agent

        # ACTION directive is followed by a non-whitespace token
        # which corresponds to action name
        action check_minutes_spent_daily_on_youtube

            # ACTION scope starts with declaration of all local variables
            decl threshold, 100
            # note that second argument might be a named systemic variable
            decl num_connections, connCount

            # after all declarations other actions are supported: example
            igt minutes_spent_daily_on_youtube, threshold
                mult fakenews_susceptibility, num_connections
            eblock

            ilte minutes_spent_daily_on_youtube, threshold
                subt fakenews_susceptibility, num_connections
                decl temp_var, 2137

                igt fakenews_susceptibility, temp_var
                    mult fakenews_susceptibility, num_connections
                eblock
            eblock

            decl tmp, 0
            
            igt tmp, 10
                decl a, 0
            eblock

            igte tmp, 10
                decl a, 0
            eblock

            ilt tmp, 10
                decl a, 0
            eblock

            ilte tmp, 10
                decl a, 0
            eblock

            ie tmp, 10
                decl a, 0
            eblock

            ine tmp, 10
                decl a, 0
            eblock

            wgt tmp, 10
                decl a, 0
            eblock

            wgte tmp, 10
                decl a, 0
            eblock

            wlt tmp, 10
                decl a, 0
                mult tmp, 2
            eblock

            wlte tmp, 10
                decl a, 0
                add tmp, 1
            eblock

            we tmp, 10
                decl a, 0
                subt tmp, 1
            eblock

            wne tmp, 10
                decl a, 0
                div tmp, 2
            eblock

        # We escape ACTION scope with EACTION
        eaction

        action find_100th_prime
            decl num_found, 0
            decl curr, 1
            wlte num_found, 100
                decl divisor, curr
                subt divisor, 1
                decl num_divisors, 0
                wgt divisor, 1
                    decl curr_copy, curr
                    wgt curr_copy, 0
                        subt curr_copy, divisor
                    eblock
                    ie curr_copy, 0
                        add num_divisors, 1
                    eblock
                    subt divisor, 1
                eblock
                ie num_divisors, 0
                    add num_found, 1
                eblock
                add curr, 1
            eblock
            decl prime_100th, curr
        eaction

    # We escape SETUPBEHAV scope with ESETUPBEHAV
    ebehav

# We escape AGENT scope with EAGENT directive
eagent
